/* ===========================
   Cyberpunk Linux Desktop UI
   WCAG-minded: high contrast, clear focus, no color-only cues
=========================== */

:root {
  /* Theme-driven wallpaper vars */
  --bg-0: #070b16;
  --bg-1: #0b1020;
  --bg-2: #081a2b;

  --flare-1: rgba(0,229,255,0.16);
  --flare-2: rgba(255,43,214,0.14);
  --flare-3: rgba(255,233,74,0.10);

  --grid: rgba(0,229,255,0.14);
  --grid2: rgba(255,43,214,0.10);
  --grid-size: 54px;

  /* UI surfaces */
  --panel: #0f1730;
  --surface: #111c3a;
  --surface-2: #0d1530;
  --win: #0b1228;

  /* Text */
  --fg: #e9f2ff;
  --muted: #b7c7e6;

  /* Borders / focus */
  --border: rgba(233,242,255,0.55);
  --border-strong: rgba(233,242,255,0.92);
  --focus: #ffe94a;

  /* Accents */
  --accent: #00e5ff;
  --accent-2: #ff2bd6;
  --accent-ink: #061018;

  /* Shadow/glow (decorative) */
  --shadow: rgba(0, 0, 0, 0.65);
  --glow: rgba(0, 229, 255, 0.28);
  --glow2: rgba(255, 43, 214, 0.22);

  --font: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
    "Liberation Mono", "Courier New", monospace;

  --panel-h: 40px;
  --titlebar-h: 30px;

  /* Centered icon grid sizing */
  --icon-col: 120px;
  --icon-gap: 16px;
}

* { box-sizing: border-box; }
html, body { height: 100%; }

body {
  margin: 0;
  font-family: var(--font);
  background: linear-gradient(180deg, var(--bg-0), var(--bg-1));
  color: var(--fg);
  overflow: hidden;
}

:focus-visible {
  outline: 3px solid var(--focus);
  outline-offset: 2px;
}

@media (prefers-reduced-motion: reduce) {
  * { scroll-behavior: auto !important; }
}

/* ===== Top Panel (centered nav) ===== */
.panel {
  position: relative; /* enables centered nav + right block */
  height: var(--panel-h);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0 10px;

  background: linear-gradient(
    180deg,
    color-mix(in srgb, var(--panel) 88%, var(--accent) 12%),
    var(--panel)
  );
  border-bottom: 1px solid var(--border);
  box-shadow: 0 12px 30px var(--shadow);
}

/* Center group of buttons */
.panel__center {
  display: flex;
  gap: 10px;
  align-items: center;
  justify-content: center;
  flex-wrap: wrap;
}

/* Keep chips pinned to the right on wider screens */
.panel__right {
  position: absolute;
  right: 10px;
  display: flex;
  gap: 10px;
  align-items: center;
  flex-wrap: wrap;
}

.panelbtn {
  font: inherit;
  color: var(--fg);
  background: linear-gradient(180deg, var(--surface), var(--surface-2));
  border: 1px solid var(--border);
  padding: 7px 12px;
  cursor: pointer;
  letter-spacing: 0.2px;
  box-shadow:
    0 0 0 1px rgba(0, 229, 255, 0.10),
    0 10px 20px var(--shadow);
}

.panelbtn:hover {
  border-color: var(--border-strong);
  box-shadow:
    0 0 0 1px rgba(0, 229, 255, 0.25),
    0 10px 20px var(--shadow);
}

.panelbtn:active { transform: translateY(1px); }

.chip {
  font-size: 12px;
  padding: 6px 10px;
  background: color-mix(in srgb, var(--accent) 18%, rgba(0,0,0,0.1));
  border: 1px solid color-mix(in srgb, var(--accent) 55%, rgba(233,242,255,0.25));
  color: var(--fg);
}

/* ===== Desktop wallpaper ===== */
.desktop {
  position: relative;
  height: calc(100% - var(--panel-h));
  width: 100%;
  background:
    radial-gradient(1100px 600px at 18% 18%, var(--flare-1), transparent 62%),
    radial-gradient(900px 520px at 82% 70%, var(--flare-2), transparent 62%),
    radial-gradient(900px 520px at 50% 92%, var(--flare-3), transparent 70%),
    linear-gradient(180deg, var(--bg-0), var(--bg-1) 45%, var(--bg-2));
}

/* Neon grid overlay */
.desktop::before {
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  opacity: 0.26;
  background-image:
    linear-gradient(to right, var(--grid) 1px, transparent 1px),
    linear-gradient(to bottom, var(--grid) 1px, transparent 1px),
    linear-gradient(45deg, rgba(255,255,255,0.04) 0 1px, transparent 1px);
  background-size:
    var(--grid-size) var(--grid-size),
    var(--grid-size) var(--grid-size),
    18px 18px;
  mask-image: radial-gradient(circle at 50% 40%, rgba(0,0,0,1), rgba(0,0,0,0.2) 72%, rgba(0,0,0,0));
}

/* Scanlines */
.desktop::after {
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  opacity: 0.07;
  background:
    repeating-linear-gradient(
      to bottom,
      rgba(0,0,0,0.40) 0px,
      rgba(0,0,0,0.40) 1px,
      transparent 2px,
      transparent 5px
    );
}

/* ===== Centered Icons =====
   Instead of anchoring top-left, we center the icon "cluster"
*/
.icons {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);

  width: min(980px, 92vw);
  max-height: calc(100% - 24px);
  overflow: auto;
  padding: 12px;

  display: grid;
  grid-auto-rows: min-content;
  grid-template-columns: repeat(auto-fit, minmax(var(--icon-col), var(--icon-col)));
  gap: var(--icon-gap);
  justify-content: center;
  align-content: center;

  /* optional: subtle plate behind icons for readability */
  background: rgba(0,0,0,0.10);
  border: 1px solid rgba(233,242,255,0.12);
  box-shadow: 0 16px 26px rgba(0,0,0,0.25);
  backdrop-filter: blur(2px);
}

.iconbtn {
  width: var(--icon-col);
  background: transparent;
  border: 1px solid transparent;
  padding: 10px 8px;
  text-align: center;
  cursor: pointer;
  user-select: none;
  color: var(--fg);
  font: inherit;
}

.iconbtn:hover {
  border-color: rgba(233,242,255,0.60);
  background: rgba(233,242,255,0.05);
}

.iconbtn[aria-selected="true"] {
  border-color: var(--border-strong);
  background: color-mix(in srgb, var(--accent) 18%, rgba(233,242,255,0.05));
  box-shadow:
    0 0 0 2px color-mix(in srgb, var(--accent) 25%, transparent),
    0 0 20px color-mix(in srgb, var(--accent) 18%, transparent);
}

.iconlabel {
  font-size: 12px;
  line-height: 1.2;
  margin-top: 10px;
  word-break: break-word;
  color: var(--fg);
}

/* ===== CSS-only folder icon ===== */
.folder-icon {
  position: relative;
  display: inline-block;
  width: 64px;
  height: 52px;
  filter: drop-shadow(0 14px 18px rgba(0,0,0,0.45));
}

.folder-back {
  position: absolute;
  left: 6px;
  top: 14px;
  width: 54px;
  height: 36px;
  background: linear-gradient(180deg,
    color-mix(in srgb, var(--surface) 80%, var(--accent) 20%),
    color-mix(in srgb, var(--surface-2) 86%, rgba(0,0,0,0.2))
  );
  border: 1px solid rgba(233,242,255,0.55);
  box-shadow: 0 0 18px var(--glow);
}

.folder-tab {
  position: absolute;
  left: 12px;
  top: 6px;
  width: 26px;
  height: 12px;
  background: linear-gradient(180deg,
    color-mix(in srgb, var(--surface) 78%, var(--accent) 22%),
    var(--surface-2)
  );
  border: 1px solid rgba(233,242,255,0.55);
  border-bottom: none;
}

.folder-front {
  position: absolute;
  left: 2px;
  top: 16px;
  width: 60px;
  height: 36px;
  background: linear-gradient(180deg,
    color-mix(in srgb, var(--surface) 75%, rgba(255,255,255,0.04)),
    color-mix(in srgb, var(--win) 78%, rgba(0,0,0,0.1))
  );
  border: 1px solid rgba(233,242,255,0.75);
  box-shadow:
    inset 0 0 0 1px rgba(0,229,255,0.12),
    0 0 18px rgba(0,229,255,0.10);
}

.folder-front::before {
  content: "";
  position: absolute;
  left: 0;
  top: 9px;
  width: 100%;
  height: 6px;
  background: linear-gradient(90deg, var(--accent), var(--accent-2));
  opacity: 0.9;
}

.folder-front::after {
  content: "";
  position: absolute;
  right: 6px;
  bottom: 6px;
  width: 10px;
  height: 10px;
  background: var(--accent);
  border: 1px solid rgba(0,0,0,0.65);
}

.folder-lines {
  position: absolute;
  left: 14px;
  top: 30px;
  width: 34px;
  height: 18px;
  background:
    repeating-linear-gradient(
      to bottom,
      rgba(233,242,255,0.60) 0px,
      rgba(233,242,255,0.60) 1px,
      rgba(0,0,0,0) 4px,
      rgba(0,0,0,0) 7px
    );
  opacity: 0.55;
  pointer-events: none;
}

/* ===== Windows ===== */
.window-layer {
  position: fixed;
  left: 0;
  right: 0;
  top: var(--panel-h);
  bottom: 0;
  pointer-events: none;
}

.window {
  pointer-events: auto;
  position: absolute;
  width: min(720px, 92vw);
  height: min(420px, 62vh);
  background: linear-gradient(180deg,
    color-mix(in srgb, var(--surface) 92%, rgba(0,0,0,0.2)),
    color-mix(in srgb, var(--surface-2) 96%, rgba(0,0,0,0.35))
  );
  color: var(--fg);
  border: 1px solid rgba(233,242,255,0.55);
  box-shadow: 0 20px 40px var(--shadow), 0 0 26px var(--glow);
}

.window.is-focused {
  border-color: rgba(233,242,255,0.92);
  box-shadow:
    0 24px 48px var(--shadow),
    0 0 32px var(--glow),
    0 0 26px var(--glow2);
}

.titlebar {
  height: var(--titlebar-h);
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 8px;
  border-bottom: 1px solid rgba(233,242,255,0.45);
  cursor: grab;
  user-select: none;
  background: rgba(0,0,0,0.22);
}

.titlebar:active { cursor: grabbing; }

.window.is-focused .titlebar {
  background: linear-gradient(90deg, var(--accent), var(--accent-2));
  color: var(--accent-ink);
  border-bottom-color: rgba(0,0,0,0.6);
}

.titlebar__title {
  font-size: 12px;
  font-weight: 800;
  letter-spacing: 0.3px;
}

.titlebar__buttons {
  display: flex;
  gap: 8px;
}

.winbtn {
  width: 18px;
  height: 18px;
  background: rgba(233,242,255,0.10);
  border: 1px solid rgba(233,242,255,0.65);
  cursor: pointer;
}

.window.is-focused .winbtn {
  background: rgba(0,0,0,0.18);
  border-color: rgba(0,0,0,0.70);
}

.winbtn:hover {
  box-shadow: 0 0 0 2px rgba(255,233,74,0.28);
}

.window__content {
  height: calc(100% - var(--titlebar-h));
  background: rgba(7,12,28,0.55);
  overflow: auto;
  padding: 12px;
}

.listbox {
  border: 1px solid rgba(233,242,255,0.55);
  background: rgba(6, 10, 20, 0.55);
}

.listrow {
  display: grid;
  grid-template-columns: 1fr 160px;
  gap: 10px;
  padding: 10px 12px;
  border-bottom: 1px solid rgba(233,242,255,0.22);
  color: var(--fg);
}

.listrow:last-child { border-bottom: none; }

.listname { font-weight: 800; }
.listmeta { text-align: right; font-size: 12px; color: var(--muted); }

.listrow:hover { background: rgba(0, 229, 255, 0.08); }

.listrow:focus-visible {
  outline: 3px solid var(--focus);
  outline-offset: -3px;
  background: rgba(255, 233, 74, 0.10);
}

a { color: var(--accent); text-decoration: underline; }
a:hover { text-decoration: none; }

hr {
  border: none;
  border-top: 1px solid rgba(233,242,255,0.35);
  margin: 12px 0;
}

.noscript {
  margin: 14px;
  padding: 12px;
  border: 1px solid rgba(233,242,255,0.55);
  background: rgba(0,0,0,0.35);
}

/* ===== Responsive tweaks for centered layout ===== */
@media (max-width: 900px) {
  :root { --icon-col: 108px; --icon-gap: 14px; }
  .window { width: 94vw; height: 60vh; }
}

@media (max-width: 600px) {
  .panel {
    height: auto;
    min-height: var(--panel-h);
    padding: 10px;
  }

  .panel__right {
    position: static; /* let it flow under centered nav */
    justify-content: center;
  }

  .panelbtn { padding: 10px 12px; }

  :root { --icon-col: 96px; --icon-gap: 12px; }

  .icons {
    top: 54%;
    width: 94vw;
    max-height: calc(100% - 18px);
  }

  .window-layer { top: 64px; }
  .window { width: 96vw; height: 72vh; }
  .titlebar { height: 36px; }
}

@media (max-width: 380px) {
  :root { --icon-col: 88px; }
  .iconlabel { font-size: 11px; }
}

/* ===========================
   Theme presets
=========================== */
:root[data-theme="teal"] {
  --bg-0: #070b16;
  --bg-1: #0b1020;
  --bg-2: #071c2e;

  --flare-1: rgba(0,229,255,0.20);
  --flare-2: rgba(255,43,214,0.16);
  --flare-3: rgba(255,233,74,0.08);

  --grid: rgba(0,229,255,0.18);
  --grid2: rgba(255,43,214,0.10);
  --grid-size: 54px;

  --panel: #0f1730;
  --surface: #111c3a;
  --surface-2: #0d1530;

  --accent: #00e5ff;
  --accent-2: #ff2bd6;

  --glow: rgba(0,229,255,0.32);
  --glow2: rgba(255,43,214,0.24);
}

:root[data-theme="amber"] {
  --bg-0: #0a0712;
  --bg-1: #120b1f;
  --bg-2: #2b1208;

  --flare-1: rgba(255,176,0,0.22);
  --flare-2: rgba(0,229,255,0.14);
  --flare-3: rgba(255,43,214,0.10);

  --grid: rgba(255,176,0,0.16);
  --grid2: rgba(0,229,255,0.10);
  --grid-size: 56px;

  --panel: #1b1230;
  --surface: #1a173a;
  --surface-2: #0e0c24;

  --accent: #ffb000;
  --accent-2: #00e5ff;
  --accent-ink: #0b0a10;

  --glow: rgba(255,176,0,0.30);
  --glow2: rgba(0,229,255,0.18);
}

:root[data-theme="violet"] {
  --bg-0: #060713;
  --bg-1: #0b0a1f;
  --bg-2: #180a2c;

  --flare-1: rgba(177,92,255,0.20);
  --flare-2: rgba(0,229,255,0.14);
  --flare-3: rgba(255,233,74,0.08);

  --grid: rgba(177,92,255,0.16);
  --grid2: rgba(0,229,255,0.10);
  --grid-size: 52px;

  --panel: #140f2a;
  --surface: #171437;
  --surface-2: #0c0a22;

  --accent: #b15cff;
  --accent-2: #00e5ff;
  --accent-ink: #070615;

  --glow: rgba(177,92,255,0.28);
  --glow2: rgba(0,229,255,0.18);
}
